@page "/ftpStatus"
@using NsxLibraryManager.Extensions
@using NsxLibraryManager.Shared.Dto
@using Microsoft.Extensions.Localization
@using NsxLibraryManager.Resources
@inject IStringLocalizer<SharedResource> Localizer

<PageTitle>@Localizer["FtpStatus"]</PageTitle>
<RadzenDataGrid 
    @ref="grid" 
    Data="@data" 
    TItem="FtpStatusGridDto"
    AllowColumnResize="true"
    AllowFiltering="false" 
    AllowPaging="true" 
    PageSize="100"
    EmptyText="@Localizer["NoQueuedTransfers"]"
    AllowSorting="false">
    <Columns>
        <RadzenDataGridColumn Property="TransferId" Title="@Localizer["TransferId"]" />
        <RadzenDataGridColumn Property="Filename" Title="@Localizer["FileName"]" />
        <RadzenDataGridColumn Property="ProgressPercentage" Title="@Localizer["Completed"]">
            <Template Context="ftpStatus">
                @($"{ftpStatus.ProgressPercentage:0.00}%")
            </Template>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="TotalBytes" Title="@Localizer["TotalBytes"]">
            <Template Context="ftpStatus">
                @ftpStatus.TotalBytes.ToHumanReadableBytes()
            </Template>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="TransferredBytes" Title="@Localizer["TransferredBytes"]" >
            <Template Context="ftpStatus">
                @ftpStatus.TransferredBytes.ToHumanReadableBytes()
            </Template>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Context="ftpStatus"  Width="50px" TextAlign="TextAlign.Right" Frozen="true" FrozenPosition="FrozenColumnPosition.Right">
            <Template Context="ftpStatus">
                @if (ftpStatus.Progress == 0)
                {
                    <RadzenButton Icon="delete" ButtonStyle="ButtonStyle.Danger" Variant="Variant.Flat" Size="ButtonSize.Medium" Shade="Shade.Lighter" class="rz-my-1 rz-ms-1" Click="@(args => DeleteUpload(ftpStatus.TransferId))" @onclick:stopPropagation="true"/>
                }
            </Template>
        </RadzenDataGridColumn>
    </Columns>
</RadzenDataGrid>
